
		/**
* @author Olga Beluga
*/
     var tracery={utilities:{}};!function(){function e(e){return'"'+e+'"'}function t(e){return e}function s(t){var s,n,o=[],i=[],a=[],l=0,u=0,c=!0;function h(e){if(u!==e){var i=t.substring(u,e);if(c){c=!1;var a=i.split(".");s=a[0],n=a.slice(1,a.length)}else o.push("multiple possible expansion symbols in tag!"+t)}u=e}for(var p=0;p<t.length;p++){var m=t.charAt(p);switch(m){case"[":0===l&&h(p),l++;break;case"]":if(0==--l){var y,g,f=t.substring(u+1,p);c?i.push(y=f):a.push(g=f),u=p+1}}}if(h(p),l>0){var d="Too many '[' in rule "+e(t);o.push(d)}if(l<0){var d="Too many ']' in rule "+e(t);o.push(d)}return{preActions:i,postActions:a,symbol:s,mods:n,raw:t,errors:o}}function n(t){var n=[],o=[];if(!("string"==typeof t||t instanceof String))return o.push("Cannot parse non-string rule "+t),n.errors=o,n;if(0===t.length)return[];var i=0,a=0,l=!1;function u(e){var o=t.substring(a,e);o.length>0&&(l?n.push(s(o)):n.push(o)),l=!l,a=e+1}for(var c=0;c<t.length;c++){var h=t.charAt(c);switch(h){case"[":i++;break;case"]":i--;break;case"#":0===i&&u(c)}}if(i>0){var p="Too many '[' in rule "+e(t);o.push(p)}if(i<0){var p="Too many ']' in rule "+e(t);o.push(p)}if(l){var p="Odd number of '#' in rule "+e(t);o.push(p)}return u(t.length),n.errors=o,n}function o(e){for(var t="",s=0;s<3*e;s++)t+=" ";return t}function i(e,t){for(var s in t)t.hasOwnProperty(s)&&(e[s]=t[s]);return e}tracery.testParse=function t(s,o){console.log("-------"),console.log("Test parse rule: "+e(s)+" "+o);var i=n(s);if(i.errors&&i.errors.length>0)for(var a=0;a<i.errors.length;a++)console.log(i.errors[a])},tracery.testParseTag=function t(n,o){console.log("-------"),console.log("Test parse tag: "+e(n)+" "+o);var i=s(n);if(i.errors&&i.errors.length>0)for(var a=0;a<i.errors.length;a++)console.log(i.errors[a])},tracery.parseRule=n,tracery.parseTag=s,function(){var e=!1,t=/xyz/.test(function(){xyz})?/\b_super\b/:/.*/;this.Class=function(){},Class.extend=function(s){var n=this.prototype;e=!0;var o=new this;for(var i in e=!1,s)o[i]="function"==typeof s[i]&&"function"==typeof n[i]&&t.test(s[i])?function(e,t){return function(){var s=this._super;this._super=n[e];var o=t.apply(this,arguments);return this._super=s,o}}(i,s[i]):s[i];function a(){!e&&this.init&&this.init.apply(this,arguments)}return a.prototype=o,a.prototype.constructor=a,a.extend=arguments.callee,a}}();var a=function(e){this.raw=e,this.sections=n(e)};a.prototype.getParsed=function(){return this.sections||(this.sections=n(raw)),this.sections},a.prototype.toString=function(){return this.raw},a.prototype.toJSONString=function(){return this.raw},Object.freeze({RED:0,GREEN:1,BLUE:2});var l=function(e){if(e.constructor===Array)e=e.slice(0,e.length);else if(e.prototype===l);else if("string"==typeof e||e instanceof String){var t=Array.prototype.slice.call(arguments);e=t}else throw console.log(e),"creating ruleset with unknown object type!";this.rules=e,this.parseAll(),this.uses=[],this.startUses=[],this.totalUses=0;for(var s=0;s<this.rules.length;s++)this.uses[s]=0,this.startUses[s]=this.uses[s],this.totalUses+=this.uses[s]};l.prototype.parseAll=function(e){for(var t=0;t<this.rules.length;t++)this.rules[t].prototype!==a&&(this.rules[t]=new a(this.rules[t]))},l.prototype.mapRules=function(e){return this.rules.map(function(t,s){return e(t,s)})},l.prototype.applyToRules=function(e){for(var t=0;t<this.rules.length;t++)e(this.rules[t],t)},l.prototype.get=function(){var e=this.getIndex();return this.rules[e]},l.prototype.getRandomIndex=function(){return Math.floor(this.uses.length*Math.random())},l.prototype.getIndex=function(){for(var e=this.getRandomIndex(),t=this.totalUses/this.uses.length,s=0;this.uses[e]>t&&s<20;)e=this.getRandomIndex(),s++;return e},l.prototype.decayUses=function(e){this.totalUses=0;for(var t=0;t<this.uses;t++)this.uses[index]*=1-e,this.totalUses+=this.uses[index]},l.prototype.testRandom=function(){console.log("Test random");for(var e=[],t=0;t<this.uses.length;t++)e[t]=0;for(var s=10*this.uses.length,t=0;t<s;t++){var n=this.getIndex();this.uses[n]+=1,e[n]++,this.decayUses(.1)}for(var t=0;t<this.uses.length;t++)console.log(t+":	"+e[t]+" 	"+this.uses[t])},l.prototype.getSaveRules=function(){return this.rules.map(function(e){return e.toJSONString()})};var u=function(e,t){this.node=e,this.grammar=e.grammar,this.raw=t};u.prototype.activate=function(){var e=this.node;e.actions.push(this),this.amended=this.grammar.flatten(this.raw);var t=s(this.amended),n=t.preActions;if(n&&n.length>0&&(this.subactions=n.map(function(t){return new u(e,t)})),t.symbol){var o=t.symbol.split(":");if(2===o.length)this.push={symbol:o[0],rules:o[1].split(",")},e.grammar.pushRules(this.push.symbol,this.push.rules);else throw"Unknown action: "+t.symbol}if(this.subactions)for(var i=0;i<this.subactions.length;i++)this.subactions[i].activate()},u.prototype.deactivate=function(){if(this.subactions)for(var e=0;e<this.subactions.length;e++)this.subactions[e].deactivate();this.push&&this.node.grammar.popRules(this.push.symbol,this.push.rules)};var c=function(e){switch(e=e.toLowerCase()){case"a":case"e":case"i":case"o":case"u":return!1}return!0};function h(e){return"y"===e.charAt(e.length-1)&&c(e.charAt(e.length-2))}var p={capitalizeAll:function(e){return e.replace(/(?:^|\s)\S/g,function(e){return e.toUpperCase()})},capitalize:function(e){return e.charAt(0).toUpperCase()+e.slice(1)},inQuotes:function(e){return'"'+e+'"'},comma:function(e){var t=e.charAt(e.length-1);return","===t||"."===t||"?"===t||"!"===t?e:e+","},beeSpeak:function(e){return e=e.replace(/s/,"zzz")},a:function(e){return c(e.charAt())?"a "+e:"an "+e},s:function(e){var t=e.charAt(e.length-1);switch(t){case"y":if(!c(e.charAt(e.length-2)))return e+"s";return e.slice(0,e.length-1)+"ies";case"x":return e.slice(0,e.length-1)+"xen";case"z":return e.slice(0,e.length-1)+"zes";case"h":return e.slice(0,e.length-1)+"hes";default:return e+"s"}},ed:function(e){var t=e.indexOf(" "),e=e,s="";t>0&&(s=e.substring(t,e.length),e=e.substring(0,t));var n=e.charAt(e.length-1);switch(n){case"y":if(c(e.charAt(e.length-2)))return e.slice(0,e.length-1)+"ied"+s;return e+"ed"+s;case"e":return e+"d"+s;default:return e+"ed"+s}}},m=0,y=Class.extend({init:function(){this.depth=0,this.id=m,m++,this.childText="[[UNEXPANDED]]"},setParent:function(e){e&&(this.depth=e.depth+1,this.parent=e,this.grammar=e.grammar)},expand:function(){return"???"},expandChildren:function(){if(this.children){this.childText="";for(var e=0;e<this.children.length;e++)this.children[e].expand(),this.childText+=this.children[e].finalText;this.finalText=this.childText}},createChildrenFromSections:function(e){var t=this;this.children=e.map(function(e){return"string"==typeof e||e instanceof String?new d(t,e):new f(t,e)})}}),g=y.extend({init:function(e,t){this._super(),this.grammar=e,this.parsedRule=n(t)},expand:function(){this.createChildrenFromSections(this.parsedRule),this.expandChildren()}}),f=y.extend({init:function(e,t){if(this._super(),!(null!==t&&"object"==typeof t)){if("string"==typeof t||t instanceof String)console.warn("Can't make tagNode from unparsed string!"),t=s(t);else throw console.log("Unknown tagNode input: ",t),"Can't make tagNode from strange tag!"}this.setParent(e),$.extend(this,t)},expand:function(){tracery.outputExpansionTrace&&console.log(r.sections),this.rule=this.grammar.getRule(this.symbol),this.actions=[],this.createChildrenFromSections(this.rule.getParsed());for(var e=0;e<this.preActions.length;e++)new u(this,this.preActions[e]).activate();this.rule.sections||console.log(this.rule),this.expandChildren();for(var e=0;e<this.actions.length;e++)this.actions[e].deactivate();this.finalText=this.childText;for(var e=0;e<this.mods.length;e++)this.finalText=this.grammar.applyMod(this.mods[e],this.finalText)},toLabel:function(){return this.symbol},toString:function(){return"TagNode '"+this.symbol+"' mods:"+this.mods+", preactions:"+this.preActions+", postactions"+this.postActions}}),d=y.extend({isLeaf:!0,init:function(e,t){this._super(),this.setParent(e),this.text=t,this.finalText=t},expand:function(){},toLabel:function(){return this.text}});function _(e,t){this.grammar=e,this.key=t,this.currentRules=void 0,this.ruleSets=[]}function v(){this.clear()}_.prototype.loadFrom=function(e){e=this.wrapRules(e),this.baseRules=e,this.ruleSets.push(e),this.currentRules=this.ruleSets[this.ruleSets.length-1]},_.prototype.mapRules=function(e){return this.currentRules.mapRules(e)},_.prototype.applyToRules=function(e){this.currentRules.applyToRules(e)},_.prototype.wrapRules=function(e){if(e.prototype!==l){if(Array.isArray(e))return new l(e);if("string"==typeof e||e instanceof String)return new l(e);throw"Unknown rules type: "+e}return e},_.prototype.pushRules=function(e){e=this.wrapRules(e),this.ruleSets.push(e),this.currentRules=this.ruleSets[this.ruleSets.length-1]},_.prototype.popRules=function(){this.ruleSets.pop(),this.ruleSets.length,this.currentRules=this.ruleSets[this.ruleSets.length-1]},_.prototype.setRules=function(e){e=this.wrapRules(e),this.ruleSets=[e],this.currentRules=e},_.prototype.addRule=function(e){this.currentRules.addRule(seed)},_.prototype.select=function(){this.isSelected=!0},_.prototype.deselect=function(){this.isSelected=!1},_.prototype.getRule=function(e){return this.currentRules.get(e)},_.prototype.toString=function(){return this.key+": "+this.currentRules+"(overlaying "+(this.ruleSets.length-1)+")"},_.prototype.toJSON=function(){var e=this.baseRules.rules.map(function(e){return'"'+e.raw+'"'});return'"'+this.key+'": ['+e.join(", ")+"]"},_.prototype.toHTML=function(e){var t='"'+this.key+'"';return e&&(t="<span class='symbol symbol_"+this.key+"'>"+t+"</span>"),t+": ["+this.baseRules.rules.map(function(t){var s=t.raw.replace(/&/g,"&amp;"),n='"'+(s=(s=s.replace(/>/g,"&gt;")).replace(/</g,"&lt;"))+'"';return e&&(n="<span class='rule'>"+n+"</span>"),n}).join(", ")+"]"},v.prototype.clear=function(){for(var e in this.symbols={},this.errors=[],this.modifiers={},p)p.hasOwnProperty(e)&&(this.modifiers[e]=p[e])},v.prototype.loadFrom=function(e){this.clear();var t,s=Object.keys(t=void 0!==e.symbols?e.symbols:e);this.symbolNames=[];for(var n=0;n<s.length;n++){var o=s[n];this.symbolNames.push(o),this.symbols[o]=new _(this,o),this.symbols[o].loadFrom(t[o])}},v.prototype.toHTML=function(e){var t,s=Object.keys(this.symbols);this.symbolNames=[];for(var n=[],o=0;o<s.length;o++){var i=s[o],a=this.symbols[i];a&&a.baseRules&&n.push("    "+this.symbols[i].toHTML(e))}return"{<p>"+(t=n.join(",</p><p>"))+"</p>}"},v.prototype.toJSON=function(){var e,t=Object.keys(this.symbols);this.symbolNames=[];for(var s=[],n=0;n<t.length;n++){var o=t[n],i=this.symbols[o];i&&i.baseRules&&s.push("    "+this.symbols[o].toJSON())}return"{\n"+(e=s.join(",\n"))+"\n}"},v.prototype.select=function(){this.isSelected=!0},v.prototype.deselect=function(){this.isSelected=!1},v.prototype.mapSymbols=function(e){var t=this.symbols;return this.symbolNames.map(function(s){return e(t[s],s)})},v.prototype.applyToSymbols=function(e){for(var t=0;t<this.symbolNames.length;t++){var s=this.symbolNames[t];e(this.symbols[s],s)}},v.prototype.addOrGetSymbol=function(e){return void 0===this.symbols[e]&&(this.symbols[e]=new _(e)),this.symbols[e]},v.prototype.pushRules=function(e,t){this.addOrGetSymbol(e).pushRules(t)},v.prototype.popRules=function(e,t){var s=this.addOrGetSymbol(e);s.popRules(),0===s.ruleSets.length&&(this.symbols[e]=void 0)},v.prototype.applyMod=function(e,t){if(!this.modifiers[e])throw console.log(this.modifiers),"Unknown mod: "+e;return this.modifiers[e](t)},v.prototype.getRule=function(e,t){var s=this.symbols[e];if(void 0===s){var n=new a("{{"+e+"}}");return n.error="Missing symbol "+e,n}var o=s.getRule();if(void 0===o){var n=new a("["+e+"]");return console.log(n.sections),n.error="Symbol "+e+" has no rule",n}return o},v.prototype.expand=function(e){var t=new g(this,e);return t.expand(),t},v.prototype.flatten=function(e){var t=new g(this,e);return t.expand(),t.childText},v.prototype.analyze=function(){for(var e in this.symbolNames=[],this.symbols)this.symbols.hasOwnProperty(e)&&this.symbolNames.push(e);for(var t=0;t<this.symbolNames.length;t++)for(var s=this.symbolNames[t],n=this.symbols[s],o=0;o<n.baseRules.length;o++){var i=n.baseRules[o];i.parsed=tracery.parse(i.raw)}},v.prototype.selectSymbol=function(e){console.log(this),this.get(e)},tracery.createGrammar=function(e){var t=new v;return t.loadFrom(e),t},tracery.test=function(){console.log("=========================================="),console.log("test tracery"),tracery.testParse("",!1),tracery.testParse("fooo",!1),tracery.testParse("####",!1),tracery.testParse("#[]#[]##",!1),tracery.testParse("#someSymbol# and #someOtherSymbol#",!1),tracery.testParse("#someOtherSymbol.cap.pluralize#",!1),tracery.testParse("#[#do some things#]symbol.mod[someotherthings[and a function]]#",!1),tracery.testParse("#[fxn][fxn][fxn[subfxn]]symbol[[fxn]]#",!1),tracery.testParse("#[fxn][#fxn#][fxn[#subfxn#]]symbol[[fxn]]#",!1),tracery.testParse("#hero# ate some #color# #animal.s#",!1),tracery.testParseTag("[action]symbol.mod1.mod2[postAction]",!1),tracery.testParse("#someSymbol# and #someOtherSymbol",!0),tracery.testParse("#[fxn][fxn][fxn[subfxn]]symbol[fxn]]#",!0),tracery.testParseTag("stuff[action]symbol.mod1.mod2[postAction]",!0),tracery.testParseTag("[action]symbol.mod1.mod2[postAction]stuff",!0),tracery.testParse("#hero# ate some #color# #animal.s#",!0),tracery.testParse("#[#setPronouns#][#setOccupation#][hero:#name#]story#",!0)}}();let pgValue=0;document.addEventListener("DOMContentLoaded",function(){let e=document.getElementById("progressbar-selector");pgValue=500,e.value=pgValue},!1);const source={me1:["mimicking nature"],you1:["inspired by machines"],me2:["materialist fiction"],you2:["phenomenological reality"],me3:["intelligence creating"],you3:["tools shaping"],me4:["organs as a tools"],you4:["tools as an organs"],me5:["integrate"],you5:["synthesize"],me6:["ecosystem"],you6:["algorithm"],me7:["number"],you7:["word"],me8:["digitally reductive"],you8:["inherently complex"],me9:["why"],you9:["what"],me10:["reproducing"],you10:["creating"],me11:["fixed meaning"],you11:["fluid sense"],me12:["making sense"],you12:["understanding meaning"],me13:["organisation"],you13:["chaos"],me14:["being radical"],you14:["avoiding conflicts"],me15:["radical truth"],you15:["conservative interpretations"],me16:["truth in lye"],you16:["lye in truth"],me17:["woe from mind"],you17:["happiness from madness"],me18:["individual perception"],you18:["collective pretending"],me19:["strength in weakness"],you19:["weakness in strength"],me20:["focusing on disposable"],you20:["avoidance of constant"],me21:["dualities dismissed"],you21:["complexities embraced"],me22:["providing an experience"],you22:["producing algorithms"],me23:["music"],you23:["silence"],me24:["touching vibrations"],you24:["touching music"],me25:["complexity of words"],you25:["simplicity of numbers"],me26:["unbearable lightness"],you26:["habitual heaviness"],me27:["simplifying reductions"],you27:["complicating details"],me28:["searching for code"],you28:["discovering magic"],me29:["digital-self"],you29:["digital twin"],me30:["theory of measure"],you30:["the science of error"],me31:["measured errors"],you31:["chaotic accuracies"],me32:["relation to complexity"],you32:["modeling of simplicity"],me33:["magic of complexity"],you33:["power of simplicity"],me34:["intuitive words"],you34:["calculated numbers"],me35:["history of moment"],you35:["definition of story"],me36:["intuitively"],you36:["randomly"],me37:["hacking loops"],you37:["looping hacks"],me38:["cybernetic"],you38:["organgic"],me39:["mechanics"],you39:["ecosystem"],me40:["delayed input"],you40:["immediate output"],me41:["everywhere"],you41:["everything"],me42:["hearing deficits"],you42:["communication breakdowns"],me43:["where"],you43:["when"],me44:["analytical detachment"],you44:["passionate attachment"],me45:["guessing the word"],you45:["knowing the number"],me46:["separation"],you46:["sorting"],me47:["repetition"],you47:["detachment"],me48:["asking permission"],you48:["breaking rules"],me49:["knowing without permission"],you49:["learning by rules"],me50:["hacking loops"],you50:["fixing breaks"],me51:["social context"],you51:["personal circumstances"],me52:["direct speech"],you52:["coded messages"],me53:["understanding superficially"],you53:["probing deeply"],me54:["abstraction in numbers"],you54:["reality in words"],me55:["x x x x x x x"],you55:["7"],me56:["infinite nothing"],you56:["limited everything"],me57:["assume"],you57:["accept"],me58:["avoiding"],you58:["standing"],me59:["words central"],you59:["numbers essential"],me60:["trust words"],you60:["trust numbers"],me61:["conversation with human"],you61:["chatting with machine"],me62:["leaving aside"],you62:["staying away"],me63:["dirty music"],you63:["pure dance"],me64:["reaction"],you64:["reflection"],me65:["health as balance"],you65:["imbalance as reality"]},grammar=tracery.createGrammar(source);let move=1,step=2;const currentNote=0,allNotes=[];let progressbarStyle="noteImage",maxTop=300;const stepSize=300,notes=["C2","D2","E2","F2","G2","A2","B2","C3","D3","E3","F3","G3","A3","B3","C4","D4","E4","F4","G4","A4","B4","C5","D5","E5","F5","G5","A5","B5","C6","D6","E6","F6","G6","A6","B6",];function playComposition(){let e=setUpSynth(),t=Tone.now();for(let s=0;s<allNotes.length;s++)e.triggerAttackRelease(allNotes[s],"0.4n",t),t+=.8}function playRandomNote(e){let t=setUpSynth(),s=window.screen.width/notes.length,n=notes[Math.ceil(e/s)];allNotes.push(n),t.triggerAttackRelease(n,"0.4n")}function playNoteOnHover(e){let t=setUpSynth(),s=e.dataset.note;t.triggerAttackRelease(s,"0.5n")}function setUpSynth(){Tone.start();let e=new Tone.PolySynth().toDestination();return e.set({volume:0,detune:0,portamento:0,envelope:{attack:.4,attackCurve:"linear",decay:.5,decayCurve:"exponential",release:.8,releaseCurve:"exponential",sustain:.4},oscillator:{detune:0,frequency:440,partialCount:8,partials:[1.2732395447351628,0,.4244131815783876,0,.25464790894703254,0,.18189136353359467,0,],phase:0,type:"square8"}}),e}function movement(e){onlyNow();let t=makeIt(e,"me"),s=makeIt(e,"you"),n=e.id;console.log("me = "+t),console.log("you = "+s),connect(document.getElementById(n),document.getElementById(t),"#000",1),connect(document.getElementById(n),document.getElementById(s),"#000",1);let o=e.style.left,i=o.substring(0,o.length-2);move<60&&move++,"1"!=n&&(playRandomNote(i),addToProgressBar(n))}function addToProgressBar(e){document.getElementById("progressbar");let t=document.getElementById("progressbar-selector");t.value=pgValue;let s=allNotes[allNotes.length-1],n=document.getElementById(e);text=n.dataset.sentence;let o=document.getElementById("written-text-inner");o.innerHTML+="<span>"+text+"</span>",o.innerHTML+="</br>","noteImage"==progressbarStyle?progressbar.innerHTML+=`<div class="progress-element" data-note="${s}" data-number="${e}" data-sentence="${text}" onmouseover="playNoteOnHover(this);"><svg xmlns="http://www.w3.org/2000/svg" width="10" height="16" viewBox="0 0 10 16" fill="none"><path d="M3 15.808C2.17467 15.808 1.468 15.514 0.88 14.926C0.293333 14.3394 0 13.6334 0 12.808C0 11.9827 0.293333 11.2764 0.88 10.689C1.46667 10.1017 2.17333 9.80802 3 9.80802C3.38333 9.80802 3.747 9.87602 4.091 10.012C4.435 10.1487 4.738 10.3537 5 10.627V0.192017H9.884V2.73102H6V12.808C6 13.6327 5.706 14.3387 5.118 14.926C4.53 15.5134 3.824 15.8074 3 15.808Z" fill="black"/></svg></div>`:"note"==progressbarStyle?progressbar.innerHTML+=`<div class="progress-element" data-note="${s}" data-number="${e}" data-sentence="${text}" onmouseover="playNoteOnHover(this);">${s}</div>`:"text"==progressbarStyle?progressbar.innerHTML+=`<div class="progress-element" data-note="${s}" data-number="${e}" data-sentence="${text}" onmouseover="playNoteOnHover(this);"><div style="display: flex;flex-direction: column; width: 9px"><svg width="9.884px" height="15.616px"  xmlns="http://www.w3.org/2000/svg"><rect width="9.884px" height="15.616px"  fill="black" /></svg><label class="label-for-progress" style="transform: translate(-50%); text-wrap: nowrap;">${text}</label></div></div>`:"number"==progressbarStyle&&(progressbar.innerHTML+=`<div class="progress-element" data-note="${s}" data-number="${e}" data-sentence="${text}" onmouseover="playNoteOnHover(this);">${e}</div>`)}function onlyNow(){let e=document.querySelectorAll(".me, .you, .w");for(let t of e)t.hasAttribute("onclick")&&(t.removeAttribute("onclick"),t.disabled=!0),t.classList.contains("now")&&t.classList.remove("now")}const styles=["text"];function switchStyles(e,t){let s=document.getElementsByClassName("singing-button");if(e.classList.contains("active")){if(1!=styles.length){e.classList.remove("active");let n=styles.indexOf(t);styles.splice(n,1)}}else e.classList.add("active"),styles.push(t);for(var o=0;o<s.length;o++)s[o].innerHTML="";for(let i=0;i<styles.length;i++){if("number"==styles[i])for(var o=0;o<s.length;o++)s[o].innerHTML+=s[o].dataset.numberview;else if("text"==styles[i])for(var o=0;o<s.length;o++)s[o].innerHTML+=s[o].dataset.sentence;else if("noteImage"==styles[i])for(var o=0;o<s.length;o++)s[o].innerHTML+='<svg xmlns="http://www.w3.org/2000/svg" width="10" height="16" viewBox="0 0 10 16" fill="none"><path d="M3 15.808C2.17467 15.808 1.468 15.514 0.88 14.926C0.293333 14.3394 0 13.6334 0 12.808C0 11.9827 0.293333 11.2764 0.88 10.689C1.46667 10.1017 2.17333 9.80802 3 9.80802C3.38333 9.80802 3.747 9.87602 4.091 10.012C4.435 10.1487 4.738 10.3537 5 10.627V0.192017H9.884V2.73102H6V12.808C6 13.6327 5.706 14.3387 5.118 14.926C4.53 15.5134 3.824 15.8074 3 15.808Z" fill="black"/></svg>';else for(var o=0;o<s.length;o++)s[o].innerHTML+=s[o].dataset.note;for(var o=0;o<s.length;o++)s[o].innerHTML+="\n"}}function reset(){location.reload()}function showPiano(){let e=document.getElementById("piano-wrapper"),t=document.getElementById("showPianobtn");e.classList.contains("active")?(e.classList.remove("active"),t.classList.remove("active")):(e.classList.add("active"),t.classList.add("active"))}function read(){let e=document.getElementById("written-text-wrapper"),t=document.getElementById("readbtn");e.classList.contains("active")?(e.classList.remove("active"),t.classList.remove("active")):(e.classList.add("active"),t.classList.add("active"))}function showInfo(){let e=document.getElementById("info"),t=document.getElementById("aboutbtn");e.classList.contains("active")?(e.classList.remove("active"),t.classList.remove("active")):(e.classList.add("active"),t.classList.add("active"))}function changeProgressbar(e){"0"==e?setProgressbar("number"):"250"==e?setProgressbar("text"):"500"==e?setProgressbar("noteImage"):setProgressbar("note"),pgValue=e}function save(){let e=new Tone.Recorder,t=new Tone.PolySynth().toDestination().connect(e);t.set({volume:0,detune:0,portamento:0,envelope:{attack:.4,attackCurve:"linear",decay:.5,decayCurve:"exponential",release:.8,releaseCurve:"exponential",sustain:.4},oscillator:{detune:0,frequency:440,partialCount:8,partials:[1.2732395447351628,0,.4244131815783876,0,.25464790894703254,0,.18189136353359467,0,],phase:0,type:"square8"}});let s=Tone.now();e.start();for(let n=0;n<allNotes.length;n++)t.triggerAttackRelease(allNotes[n],"0.4n",s),s+=.8;setTimeout(async()=>{let t=await e.stop(),s=URL.createObjectURL(t),n=document.createElement("a");n.download="recording.mp3",n.href=s,n.click()},.8*allNotes.length*1e3)}function setProgressbar(e){let t=document.getElementsByClassName("progress-element");if("note"==e){for(let s=0;s<t.length;s++)t[s].innerHTML=t[s].dataset.note;progressbarStyle="note"}else if("number"==e){for(let n=0;n<t.length;n++)t[n].innerHTML=t[n].dataset.number;progressbarStyle="number"}else if("noteImage"==e){for(let o=0;o<t.length;o++)t[o].innerHTML='<svg xmlns="http://www.w3.org/2000/svg" width="10" height="16" viewBox="0 0 10 16" fill="none"><path d="M3 15.808C2.17467 15.808 1.468 15.514 0.88 14.926C0.293333 14.3394 0 13.6334 0 12.808C0 11.9827 0.293333 11.2764 0.88 10.689C1.46667 10.1017 2.17333 9.80802 3 9.80802C3.38333 9.80802 3.747 9.87602 4.091 10.012C4.435 10.1487 4.738 10.3537 5 10.627V0.192017H9.884V2.73102H6V12.808C6 13.6327 5.706 14.3387 5.118 14.926C4.53 15.5134 3.824 15.8074 3 15.808Z" fill="black"/></svg>';progressbarStyle="noteImage"}else if("text"==e){for(let i=0;i<t.length;i++)t[i].innerHTML=`<div style="display: flex;flex-direction: column; width: 9px"><svg width="9.884px" height="15.616px"  xmlns="http://www.w3.org/2000/svg"><rect width="9.884px" height="15.616px"  fill="black" /></svg><label class="label-for-progress" style="transform: translate(-50%); text-wrap: nowrap;">${t[i].dataset.sentence}</label></div>`;progressbarStyle="text"}}function makeIt(e,t){let s=e.offsetTop;e.offsetLeft;let n=document.createElement("button"),o=step;n.setAttribute("id",o),n.setAttribute("onclick","movement(this)"),n.classList.add(t),n.classList.add("now"),n.classList.add("singing-button"),n.dataset.numberview=o;let i=grammar.flatten(`#${t}${move}#`);n.dataset.sentence=i;let a=getRandomNumber(maxTop+10,maxTop+300);n.style.top=`${a}px`;let l=getRandomNumber(50,innerWidth-150);n.style.left=`${l}px`;let u=window.screen.width/notes.length,c=notes[Math.ceil(l/u)];n.dataset.note=c,document.body.appendChild(n),maxTop=Math.max(a,s),document.body.style.height=`${maxTop+450}px`,step++;for(let h=0;h<styles.length;h++)"number"==styles[h]?n.innerHTML+=n.dataset.numberview:"text"==styles[h]?n.innerHTML+=n.dataset.sentence:"noteImage"==styles[h]?n.innerHTML+='<svg xmlns="http://www.w3.org/2000/svg" width="10" height="16" viewBox="0 0 10 16" fill="none"><path d="M3 15.808C2.17467 15.808 1.468 15.514 0.88 14.926C0.293333 14.3394 0 13.6334 0 12.808C0 11.9827 0.293333 11.2764 0.88 10.689C1.46667 10.1017 2.17333 9.80802 3 9.80802C3.38333 9.80802 3.747 9.87602 4.091 10.012C4.435 10.1487 4.738 10.3537 5 10.627V0.192017H9.884V2.73102H6V12.808C6 13.6327 5.706 14.3387 5.118 14.926C4.53 15.5134 3.824 15.8074 3 15.808Z" fill="black"/></svg>':n.innerHTML+=n.dataset.note,n.innerHTML+="\n";return o}function getRandomNumber(e,t){return Math.floor(Math.random()*(t-e))+e}function connect(e,t,s,n){console.log(e),console.log(t);let o=getOffset(e),i=getOffset(t),a=o.left,l=o.top+o.height,u=i.left,c=i.top,h=Math.sqrt((u-a)*(u-a)+(c-l)*(c-l)),p=Math.atan2(l-c,a-u)*(180/Math.PI),m=`<div style='opacity: 1; padding:0px; margin:0px; height:${n}px; background-color:${s}; line-height:1px; position:absolute; left:${(a+u)/2-h/2}px; top:${(l+c)/2-n/2}px; width:${h}px; -moz-transform:rotate(${p}deg); -webkit-transform:rotate(${p}deg); -o-transform:rotate(${p}deg); -ms-transform:rotate(${p}deg); transform:rotate(${p}deg);' />`;document.body.innerHTML+=m}function getOffset(e){let t=e.getBoundingClientRect();return{left:t.left+window.pageXOffset,top:t.top+window.pageYOffset,width:t.width||e.offsetWidth,height:t.height||e.offsetHeight}}